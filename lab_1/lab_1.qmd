---
title: 
    "Применение технологий искусственного интеллекта и машинного обучения для поиска угроз информационной безопасности"
author: "Marshev Leonid"
format: 
    md:
        output-file: README.md
---

# Лабораторная работа №1
Использование технологии Yandex Query для анализа данных сетевой активности

## Цель работы

1\. Изучить возможности технологии Yandex Query для анализа структурированных наборов данных

2\. Получить навыки построения аналитического пайплайна для анализа данных с помощью сервисов Yandex Cloud

3\. Закрепить практические навыки использования SQL для анализа данных сетевой активности в сегментированной корпоративной сети

## Исходные данные

1.  ОС Windows 10
2.  RStudio Desktop
3.  Yandex Cloud: S3 Object Storage
4.  Yandex Query
5.  Dataset: yaqry_dataset.pqt

## Ход работы

### Проверить доступность данных в Yandex Object Storage

Проверьте доступность данных (файл yaqry_dataset.pqt) в бакете arrow-datasets
S3 хранилища Yandex Object Storage. Проверить можно просто перейдя по правильно
сконструированному URL в браузере.

https://storage.yandexcloud.net/arrow-datasets/yaqry_dataset.pqt 

### Подключить бакет как источник данных для Yandex Query

Yandex Query – это облачное решение для анализа данных, в котором задачи организации хранения, обеспечения доступа и выполнения первичного анализа данных полностью берет на себя сервис-провайдер, то есть Yandex Cloud.

1\. Создадим соединение для бакета в S3 хранилище

2\. Заполняем поля с учетом допустимых символов, выбираем тип аутентификации. Вводим имя бакета в соответствующее поле и сохраняем

![](img/1.png)

3\. Укажем какой объект использовать в качестве источника данных. Для этого нужно сделать привязку данных.

4\. Настройка привязки данных

![](img/2.png)

5\. Описание состава и формата входных данных

![](img/3.png)

Формат данных
SCHEMA=( timestamp TIMESTAMP NOT NULL, src STRING, dst STRING, port INT32, bytes INT32 )

![](img/4.png)

Если настройка выполнена правильно, то получится выполнить  аналитический запрос. Результат должен быть непустым

![](img/5.png)

### Анализ
1\. Известно, что IP адреса внутренней сети начинаются с октетов принадлежащих интервалу [12-14]. Определите количество хостов внутренней сети, представленных в датасете.

Для этого выполним запрс, который будет отбирать из источников только определенные IP и считать их количество.

```sql 
SELECT COUNT(distinct src) AS amount
FROM `datasetsveta1`
WHERE src REGEXP ‘(^12\.)’ or src REGEXP ‘(^13\.)’ or src REGEXP ‘(^14\.)’;
```

![](img/6.png)

2\. Определите суммарный объем исходящего трафика

Для этого необходимо суммировать байты трафика, исходящих IP которых находитсяя во внутренней сети, а IP приемника отличается. Сразу пересчитаем в МБ

```sql 
SELECT sum(bytes) / 1024 / 1024 as traffic
FROM `datasetsveta1`
WHERE 1 = 1
    and ( src REGEXP "(^12\.)" 
        or src REGEXP "(^13\.)" 
        or src REGEXP "(^14\.)") 
    and dst not REGEXP "(^1[2-4]\.)";
```

![](img/7.png)

3\. Определите суммарный объем входящего трафика

Для этого необходимо суммировать байты трафика, который приходит на IP внутренней сети, но источник не принадлежит ей. Сразу пересчитаем в МБ

```sql 
SELECT sum(bytes) / 1024 / 1024 as traffic
FROM `datasetsveta1`
WHERE 1 = 1
    and ( dst REGEXP "(^12\.)" 
        or dst REGEXP "(^13\.)" 
        or dst REGEXP "(^14\.)") 
    and src not REGEXP "(^1[2-4]\.)";
```


![](img/8.png)


```{r}
sprintf("Задание выполнено!")
```

## Оценка результатов

Задача выполнена при помощи облачных сервисов Yandex Cloud и технологии Yandex Query, удалось познакомится с их функционалом и особенностями.

# Вывод
В данной работе я смог закрепить практические навыки использования SQL для анализа данных сетевой активности в сегментированной корпоративной сети и получить навыки построения аналитического пайплайна для анализа данных

